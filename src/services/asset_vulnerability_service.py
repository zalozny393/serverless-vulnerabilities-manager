from typing import Iterable

from src.models.asset_vulnerability_model import AssetVulnerabilityModel
from src.services.database_service import DatabaseService


class AssetVulnerabilityService:
    def __init__(self):
        self.database_service = DatabaseService()

    def get_asset_vulnerabilities_by_group(self, group_name: str, status: int = 0) -> Iterable:
        asset_vulnerabilities = self.database_service.query(pk_value=AssetVulnerabilityModel.generate_pk(group_name, status))
        return list(map(lambda av: AssetVulnerabilityModel.from_item(av), asset_vulnerabilities))
