from src.models.group import Group


class AssetVulnerability(Group):
    def __init__(self,
                 group: str,
                 ip: str,
                 vulnerability_id: str,
                 severity: int,
                 status: int = 0,
                 name: str = '',
                 description: str = '',
                 ):
        super().__init__(group)
        self.ip = ip
        self.vulnerability_id = vulnerability_id
        self.severity = severity
        self.status = status
        self.description = description
        self.name = name
        self.type = 'AssetVulnerability'

    @staticmethod
    def to_item(av: 'AssetVulnerability') -> dict:
        return {**av.keys(), **{
            'severity': av.severity,
            'status': av.status,
            'name': av.name,
            'description': av.description,
            'type': av.type
        }}

    @property
    def sk(self) -> str:
        return f'ASSET#{self.ip}#VULNERABILITY#{self.vulnerability_id}'
